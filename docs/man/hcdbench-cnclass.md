# hcdbench cnclass

`hcdbench cnclass` command to calculate CN state detection metrics at the bin level.

## Overview

The `cnclass.py` script is designed to evaluate the detection accuracy of CN states at the bin level. It processes input data files, calculates key metrics, and outputs categorized CNV results and evaluation metrics for further analysis.

## Parameters
```shell
usage: hcdbench cnclass [-h] [--tool-maternal-cna-files  [...]] [--tool-paternal-cna-files  [...]] [--tool-names  [...]] [--profile-maternal-cna-files]
                        [--profile-paternal-cna-files] [--output-dir]

options:
  -h, --help            show this help message and exit
  --tool-maternal-cna-files  [ ...]
                        Paths to the maternal/minor CNA files generated by different tools. , separated by spaces
  --tool-paternal-cna-files  [ ...]
                        Paths to the paternal/major CNA files generated by different tools. , separated by spaces
  --tool-names  [ ...]  List of tool names corresponding to the CNA files.
  --profile-maternal-cna-files 
                        Path to the maternal/minor ground truth CNA file.
  --profile-paternal-cna-files 
                        Path to the paternal/minor ground truth CNA file.
  --type 				Type of CNA to analyzs. Choose between 'acCNA' and 'hcCNA'.
  --output-dir          Path to the file where the results will be saved, default: './output'
```

## Input

The script requires the following inputs:

1. **Maternal and Paternal CNA Files**:
   - Paths to the CNA files generated by tools for maternal and paternal data.

2. **Ground Truth CNA Files**:
   - Ground truth data for maternal and paternal CN states.

3. **Tool Names**:
   - List of names for the tools corresponding to the provided CNA files.

4. **Output Directory**:
   - Optional parameter, default path is `./output`.

## Output

1. **Categorized CNV Files**:
   - Categorized CNV files are generated based on predefined conditions (e.g., `>=2`, `=1`, `=0`).
   - Separate files for maternal and paternal data are created.
2. **Evaluation Metrics**:
   - Metrics such as AUROC, AUPRC, accuracy, precision, recall, and F1 score are calculated for each tool.
   - Results are saved as CSV files for easy interpretation.

## Example Usage

For acCNA detection:

```shell
hcdbench cnclass \
  --tool-maternal-cna-files data/chisel_5x_minor_cnv.csv \
  --tool-paternal-cna-files data/chisel_5x_major_cnv.csv \
  --tool-name chisel_5x_acCNA \
  --profile-maternal-cna-files data/ground_truth_minor_cnv.csv \
  --profile-paternal-cna-files data/ground_truth_major_cnv.csv \
  --type acCNA
```

For hcCNA detection:

```shell
hcdbench cnclass \
  --tool-maternal-cna-files data/chisel_5x_maternal_cnv.csv \
  --tool-paternal-cna-files data/chisel_5x_paternal_cnv.csv \
  --tool-name chisel_5x_hcCNA \
  --profile-maternal-cna-files data/ground_truth_maternal_cnv.csv \
  --profile-paternal-cna-files data/ground_truth_paternal_cnv.csv \
  --type hcCNA
  --output './output_hcCNA'
```

This command processes the specified input files, evaluates the CN state detection metrics for each tool, and saves the results in the `./output` directory.

