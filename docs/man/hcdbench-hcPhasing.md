# hcdbench hcPhasing

`hcdbench hcPhasing` command is used to evaluate haplotype phasing accuracy using **Mismatch Error** and **Switch Error**.

## Overview

This script implements a subcommand named `hcPhasing`, which quantifies how accurately predicted haplotypes match the ground truth. It evaluates two core metrics:

- **Mismatch Error**: Proportion of individual loci where the predicted haplotype differs from the ground truth.
- **Switch Error**: Frequency of phase switches needed to reconcile the predicted haplotype with the ground truth across consecutive loci.



## Parameters

```
usage: hcdbench hcPhasing [-h] 
       --tool-maternal-cna-files  [...] 
       --tool-paternal-cna-files  [...] 
       --ground-truth-maternal-file  
       --ground-truth-paternal-file  
       --tool-names  [...] 
       [--output-dir]

options:
  -h, --help                      Show this help message and exit
  --tool-maternal-cna-files [...]   Paths to maternal CNA files generated by different tools. Space-separated list.
  --tool-paternal-cna-files [...]   Paths to paternal CNA files generated by different tools. Space-separated list.
  --ground-truth-maternal-file      Path to the ground truth maternal CNA file.
  --ground-truth-paternal-file      Path to the ground truth paternal CNA file.
  --tool-names  [...]               Names of tools corresponding to the input CNA files.
  --output-dir                      Directory where output file will be saved. Default: './output'
  
```

## Input

1. **Maternal and Paternal CNA Files**:

   - Output CNA predictions from various tools, for both maternal and paternal haplotypes.

2. **Ground Truth Files**:

   - Reference maternal and paternal haplotype CNA data.

3. **Tool Names**:

   - Names associated with each tool’s prediction, in the same order as the CNA input files.

4. **Output Directory** *(optional)*:

   - Path where the results file will be written. Default is `./output`.

     

## Output

1. The output is saved as a CSV file named `hcPhasing.csv` in the specified output directory. It contains the following columns:

   | Column Name                  | Description                                                  |
   | ---------------------------- | ------------------------------------------------------------ |
   | `tool_name`                  | The name of the tool being evaluated                         |
   | `cell_group`                 | Identifier for the group of cells being evaluated (e.g., clone or sample cluster) |
   | `mismatch_count`             | Total number of loci where predicted and ground truth haplotypes differ |
   | `total`                      | Total number of loci compared                                |
   | `mismatch_ratio`             | `mismatch_count / total` — fraction of mismatched loci       |
   | `switch_error_count`         | Total number of incorrect switch points between consecutive loci |
   | `total_switch_compare_count` | Total number of valid comparisons between adjacent loci      |
   | `switch_error_ratio`         | `switch_error_count / total_switch_compare_count` — frequency of phasing switch errors |



## Example Usage

```
hcdbench hcPhasing \
 --tool-maternal-cna-files data/chisel_5x_maternal_cnv.csv \
 --tool-paternal-cna-files data/chisel_5x_paternal_cnv.csv \
 --ground-truth-maternal-file data/ground_truth_maternal_cnv.csv \
 --ground-truth-paternal-file data/ground_truth_paternal_cnv.csv \
 --tool-names chisel_5x
```